{% extends 'user_interface/base.html' %}

{% block title %}Training Exercises - Dyslexia Helper{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-body text-center">
                <h2><span class="emoji">üéÆ</span> Fun Learning Exercises</h2>
                <p class="lead">Practice reading, writing, and pronunciation with interactive games!</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    {% for exercise in exercises %}
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card exercise-card h-100" onclick="location.href='{% url 'start_exercise' exercise.id %}'">
            <div class="card-body">
                <div class="text-center mb-3">
                    {% if exercise.exercise_type == 'reading' %}
                        <i class="fas fa-book fa-3x text-primary"></i>
                    {% elif exercise.exercise_type == 'writing' %}
                        <i class="fas fa-pencil-alt fa-3x text-success"></i>
                    {% elif exercise.exercise_type == 'phoneme' %}
                        <i class="fas fa-microphone fa-3x text-warning"></i>
                    {% else %}
                        <i class="fas fa-brain fa-3x text-info"></i>
                    {% endif %}
                </div>
                
                <h5 class="card-title">{{ exercise.name }}</h5>
                <p class="card-text">{{ exercise.description }}</p>
                
                <div class="mb-3">
                    <span class="badge bg-{% if exercise.difficulty_level == 'beginner' %}success{% elif exercise.difficulty_level == 'intermediate' %}warning{% else %}danger{% endif %}">
                        {{ exercise.get_difficulty_level_display }}
                    </span>
                    <span class="badge bg-info">
                        <i class="fas fa-clock"></i> {{ exercise.expected_duration }} min
                    </span>
                </div>
                
                {% for progress in user_progress %}
                    {% if progress.exercise.id == exercise.id %}
                    <div class="mb-3">
                        <div class="d-flex justify-content-between">
                            <small>Progress</small>
                            <small>{{ progress.mastery_level|floatformat:0 }}%</small>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" style="width: {{ progress.mastery_level|floatformat:0 }}%"></div>
                        </div>
                        <small class="text-muted">
                            <i class="fas fa-trophy"></i> Best: {{ progress.best_score|floatformat:0 }}% | 
                            <i class="fas fa-repeat"></i> Attempts: {{ progress.attempts }}
                        </small>
                    </div>
                    {% endif %}
                {% empty %}
                    <div class="mb-3">
                        <small class="text-muted">New exercise - let's get started!</small>
                    </div>
                {% endfor %}
                
                <button class="btn btn-primary w-100">
                    <i class="fas fa-play"></i> Start Exercise
                </button>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12">
        <div class="card">
            <div class="card-body text-center">
                <i class="fas fa-gamepad fa-3x text-muted mb-3"></i>
                <h4>No exercises available yet</h4>
                <p class="text-muted">Check back soon for fun learning activities!</p>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4><span class="emoji">üèÜ</span> Your Progress Summary</h4>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-trophy text-warning"></i>
                        </div>
                        <h5>{{ user_progress|length }}</h5>
                        <p class="text-muted">Exercises Started</p>
                    </div>
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-star text-success"></i>
                        </div>
                        <h5>
                            {% if user_progress %}
                                {% for progress in user_progress %}
                                    {% if forloop.first %}{{ progress.best_score|floatformat:0 }}{% endif %}
                                {% endfor %}
                            {% else %}
                                0
                            {% endif %}%
                        </h5>
                        <p class="text-muted">Best Score</p>
                    </div>
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-clock text-info"></i>
                        </div>
                        <h5>
                            {% if user_progress %}
                                {% for progress in user_progress %}
                                    {% if forloop.first %}{{ progress.total_time_spent|floatformat:0 }}{% endif %}
                                {% endfor %}
                            {% else %}
                                0
                            {% endif %}
                        </h5>
                        <p class="text-muted">Minutes Practiced</p>
                    </div>
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-medal text-primary"></i>
                        </div>
                        <h5>
                            {% if user_progress %}
                                {% for progress in user_progress %}
                                    {% if progress.mastery_level >= 0.8 %}{{ forloop.counter0|add:1 }}{% endif %}
                                {% endfor %}
                            {% else %}
                                0
                            {% endif %}
                        </h5>
                        <p class="text-muted">Mastered</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body text-center">
                <h4><span class="emoji">üí°</span> Learning Tips</h4>
                <div class="row">
                    <div class="col-md-4">
                        <div class="feature-icon">
                            <i class="fas fa-target"></i>
                        </div>
                        <h6>Set Goals</h6>
                        <p>Try to complete at least one exercise each day!</p>
                    </div>
                    <div class="col-md-4">
                        <div class="feature-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h6>Stay Positive</h6>
                        <p>Remember, practice makes perfect! Don't give up!</p>
                    </div>
                    <div class="col-md-4">
                        <div class="feature-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <h6>Ask for Help</h6>
                        <p>Don't hesitate to ask teachers or parents for help!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Add hover effects to exercise cards
document.querySelectorAll('.exercise-card').forEach(card => {
    card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-5px)';
    });
    
    card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
    });
});
</script>
{% endblock %}
