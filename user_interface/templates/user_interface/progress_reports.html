{% extends 'user_interface/base.html' %}

{% block title %}Progress Reports - Dyslexia Helper{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-body text-center">
                <h2><span class="emoji">ðŸ“ˆ</span> Your Progress Reports</h2>
                <p class="lead">Track your learning journey and see how much you've improved!</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card mb-4">
            <div class="card-header">
                <h4><span class="emoji">ðŸ“Š</span> Current Month Summary</h4>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-trophy text-warning"></i>
                        </div>
                        <h3>{{ current_report.total_exercises_completed }}</h3>
                        <p class="text-muted">Exercises Completed</p>
                    </div>
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-star text-success"></i>
                        </div>
                        <h3>{{ current_report.average_score|floatformat:0 }}%</h3>
                        <p class="text-muted">Average Score</p>
                    </div>
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-clock text-info"></i>
                        </div>
                        <h3>{{ current_report.total_time_spent }}</h3>
                        <p class="text-muted">Minutes Practiced</p>
                    </div>
                    <div class="col-md-3">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line text-primary"></i>
                        </div>
                        <h3>{{ current_report.reading_improvement|floatformat:1 }}</h3>
                        <p class="text-muted">Reading Improvement</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-book"></i> Reading Progress</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Reading Improvement</span>
                        <span class="fw-bold">{{ current_report.reading_improvement|floatformat:1 }}%</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar bg-success"
                            data-progress="{{ current_report.reading_improvement|floatformat:0 }}"></div>
                    </div>
                </div>
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Writing Improvement</span>
                        <span class="fw-bold">{{ current_report.writing_improvement|floatformat:1 }}%</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar bg-primary"
                            data-progress="{{ current_report.writing_improvement|floatformat:0 }}"></div>
                    </div>
                </div>
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span>Phoneme Improvement</span>
                        <span class="fw-bold">{{ current_report.phoneme_improvement|floatformat:1 }}%</span>
                    </div>
                    <div class="progress">
                        <div class="progress-bar bg-info"
                            data-progress="{{ current_report.phoneme_improvement|floatformat:0 }}"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-target"></i> Goals & Achievements</h5>
            </div>
            <div class="card-body">
                <div class="achievement-item mb-3">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-medal text-warning fa-2x me-3"></i>
                        <div>
                            <h6 class="mb-0">Practice Streak</h6>
                            <small class="text-muted">Keep practicing every day!</small>
                        </div>
                    </div>
                </div>

                <div class="achievement-item mb-3">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-star text-success fa-2x me-3"></i>
                        <div>
                            <h6 class="mb-0">High Scores</h6>
                            <small class="text-muted">Great job on your recent exercises!</small>
                        </div>
                    </div>
                </div>

                <div class="achievement-item mb-3">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-clock text-info fa-2x me-3"></i>
                        <div>
                            <h6 class="mb-0">Time Invested</h6>
                            <small class="text-muted">You've spent {{ current_report.total_time_spent }} minutes
                                learning!</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% if reports %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4><span class="emoji">ðŸ“…</span> Historical Reports</h4>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Exercises</th>
                                <th>Average Score</th>
                                <th>Time Spent</th>
                                <th>Reading</th>
                                <th>Writing</th>
                                <th>Phoneme</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for report in reports %}
                            <tr>
                                <td>{{ report.report_date|date:"M d, Y" }}</td>
                                <td>{{ report.total_exercises_completed }}</td>
                                <td>
                                    <span
                                        class="badge bg-{% if report.average_score >= 80 %}success{% elif report.average_score >= 60 %}warning{% else %}danger{% endif %}">
                                        {{ report.average_score|floatformat:0 }}%
                                    </span>
                                </td>
                                <td>{{ report.total_time_spent }} min</td>
                                <td>{{ report.reading_improvement|floatformat:1 }}%</td>
                                <td>{{ report.writing_improvement|floatformat:1 }}%</td>
                                <td>{{ report.phoneme_improvement|floatformat:1 }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h4><span class="emoji">ðŸŽ¯</span> Recommendations</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="recommendation-card">
                            <div class="feature-icon">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <h6>Reading Practice</h6>
                            <p>Continue with reading exercises to improve fluency and comprehension.</p>
                            <a href="{% url 'training_exercises' %}" class="btn btn-outline-primary btn-sm">
                                Start Reading Exercises
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="recommendation-card">
                            <div class="feature-icon">
                                <i class="fas fa-pencil-alt"></i>
                            </div>
                            <h6>Writing Practice</h6>
                            <p>Work on handwriting and creative writing skills.</p>
                            <a href="{% url 'training_exercises' %}" class="btn btn-outline-success btn-sm">
                                Start Writing Exercises
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="recommendation-card">
                            <div class="feature-icon">
                                <i class="fas fa-microphone"></i>
                            </div>
                            <h6>Phoneme Practice</h6>
                            <p>Focus on sound recognition and pronunciation exercises.</p>
                            <a href="{% url 'training_exercises' %}" class="btn btn-outline-info btn-sm">
                                Start Phoneme Exercises
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body text-center">
                <h4><span class="emoji">ðŸŒŸ</span> Keep Up the Great Work!</h4>
                <p class="lead">Your dedication to learning is amazing! Every exercise you complete helps you grow
                    stronger.</p>
                <div class="mt-3">
                    <a href="{% url 'training_exercises' %}" class="btn btn-primary me-2">
                        <i class="fas fa-gamepad"></i> Continue Practicing
                    </a>
                    <a href="{% url 'upload_data' %}" class="btn btn-success">
                        <i class="fas fa-upload"></i> Upload New Samples
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<style>
    .recommendation-card {
        text-align: center;
        padding: 1rem;
        border: 1px solid #e9ecef;
        border-radius: 10px;
        height: 100%;
    }

    .achievement-item {
        border-left: 4px solid #28a745;
        padding-left: 1rem;
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.progress-bar[data-progress]').forEach(function (bar) {
            const progress = bar.getAttribute('data-progress');
            bar.style.width = progress + '%';
        });
    });
</script>
{% endblock %}